(window["webpackJsonpexpenses-react"]=window["webpackJsonpexpenses-react"]||[]).push([[10],{736:function(e,t,a){"use strict";a.r(t);var n=a(77),r=a(13),o=a(0),c=a.n(o),i=a(5),s=a(66),l=a.n(s),m=a(11),u=a(726),d=a(718),p=a.n(d),b=a(6),g=a.n(b),h=a(12),f=a(52),x=a(39);var w=a(29),j=a(65),O=a.n(j),E=function(e){return c.a.createElement("svg",Object.assign({viewBox:"2 2 18 18"},e,{fill:"none",xmlns:"http://www.w3.org/2000/svg"}),c.a.createElement("path",{fill:e.fill||"#000000",opacity:e.opacity||"",d:"M 6 3 C 6 3 5 2.99997 5 4 L 3 4 L 3 7 L 3 18 L 3 19 L 19 19 L 19 18 L 19 7 L 19 4 L 17 4 C 17 2.99997 16 3 16 3 L 13 3 C 13 3 12 2.99997 12 4 L 10 4 C 10 2.99997 9 3 9 3 L 6 3 z M 6 4 L 9 4 L 9 5 L 6 5 L 6 4 z M 13 4 L 16 4 L 16 5 L 13 5 L 13 4 z M 4 7 L 18 7 L 18 18 L 4 18 L 4 7 z M 6 8 L 6 10 L 8 10 L 8 8 L 6 8 z M 10 8 L 10 10 L 12 10 L 12 8 L 10 8 z M 14 8 L 14 10 L 16 10 L 16 8 L 14 8 z M 6 11 L 6 13 L 8 13 L 8 11 L 6 11 z M 10 11 L 10 13 L 12 13 L 12 11 L 10 11 z M 14 11 L 14 13 L 16 13 L 16 11 L 14 11 z M 14 14 L 14 16 L 16 16 L 16 14 L 14 14 z "}))},v=a(274),C=i.a.create({amount:{whiteSpace:"nowrap",fontSize:27,lineHeight:"27px",fontWeight:600},category:{fontSize:20,fontWeight:600,lineHeight:"21px",whiteSpace:"nowrap"},container:{backgroundColor:"#FDFDFD",border:"1px solid #E7EBF0",borderRadius:4,color:"#172b4d",marginBottom:10,minHeight:80,padding:"10px 20px","@media (max-width: 488px)":{padding:"5px 10px"},":last-child":{marginBottom:0}},currency:{fontSize:10,marginBottom:2,marginLeft:2},editButton:{backgroundColor:"#FFFFFF",border:"1px solid rgb(35, 112, 163)",borderRadius:5,color:"rgb(35, 112, 163)",cursor:"pointer",fontWeight:500,padding:"2px 8px",textAlign:"center",":hover":{backgroundColor:"#FCFCFC"}},lastColumn:{maxWidth:300,minWidth:10,"@media (max-width: 654px)":{flexDirection:"row-reverse",justifyContent:"space-between",marginTop:10,width:"100%",maxWidth:"none"}},method:{fontSize:18,marginTop:10},tag:{borderRadius:5,fontWeight:600,padding:"8px 8px",textAlign:"center",marginTop:4,marginRight:4}}),L=Object(o.forwardRef)((function(e,t){var a=e.expense,n=e.tags,r=e.onEditClick;return c.a.createElement(m.Column,{className:Object(i.b)(C.container),componentRef:t},c.a.createElement(m.Row,{horizontal:"spaced",breakpoints:{654:"column"}},c.a.createElement(m.Row,{flexGrow:3},c.a.createElement(m.Column,{flexGrow:1,vertical:"spaced",style:{maxWidth:300,minWidth:300},breakpoints:{744:{minWidth:200},488:{minWidth:150,maxWidth:150},360:{minWidth:120,maxWidth:120}}},c.a.createElement(m.Row,{nowrap:"true",vertical:"end"},c.a.createElement(m.Row,{className:Object(i.b)(C.amount)},"$ ",Object(x.j)(a.amount,0)),c.a.createElement("span",{className:Object(i.b)(C.currency)},"/ ",a.currency)),c.a.createElement(m.Row,{style:{marginTop:10},nowrap:"true",vertical:"center"},c.a.createElement(E,{width:22}),c.a.createElement("span",{style:{marginLeft:4}},O()(+a.date).format("DD/MM/YYYY"))),c.a.createElement(m.Row,{style:{marginTop:10},nowrap:"true",vertical:"center"},c.a.createElement(v.a,{width:22}),c.a.createElement("span",{style:{marginLeft:4}},a.city))),c.a.createElement(m.Column,{flexGrow:1,vertical:"spaced",breakpoints:{744:{minWidth:200},488:{marginTop:10,minWidth:0},340:{marginLeft:4}}},c.a.createElement(m.Column,null,c.a.createElement("span",{className:Object(i.b)(C.category)},a.category),c.a.createElement("span",{style:{marginTop:4,fontSize:12}},a.description)),c.a.createElement("span",{className:Object(i.b)(C.method)},a.method))),c.a.createElement(m.Column,{className:Object(i.b)(C.lastColumn),flexGrow:1,horizontal:"end",vertical:"spaced"},c.a.createElement("span",{onClick:function(){return r(a.id)},className:Object(i.b)(C.editButton)},"EDIT"),c.a.createElement(m.Row,{wrap:!0,horizontal:"end",breakpoints:{654:{justifyContent:"flex-start"}}},a.tags&&a.tags.length>0&&a.tags.split(",").map((function(e,t){return c.a.createElement("span",{key:"".concat(t,"-").concat(e),className:Object(i.b)(C.tag),style:{backgroundColor:n[e]&&n[e].backgroundColor||"#38bcfb",color:n[e]&&n[e].color||"white"}},e.trim())}))))))})),y=a(20),k=a(708),T=i.a.create({closeButton:{border:"1px dashed",cursor:"pointer",lineHeight:"20px",padding:"5px 8px",right:5,top:5,":hover":{backgroundColor:"rgba(0,0,0,.05)"}},container:{backgroundColor:"white",maxWidth:548,minWidth:"30vw",width:"100%","@media (max-width: 1068px)":{minWidth:600},"@media (max-width: 768px)":{minWidth:"80vw"}},title:{margin:0},subTitle:{margin:"10px 0px 2px 0px",fontSize:16},inputGroupRow:{width:"50%",":last-child":{marginLeft:8},"@media (max-width: 768px)":{marginLeft:0,width:"100%"}}});var R=function(e){var t=e.filters,a=void 0===t?{}:t,s=e.onApply,u=e.onClose,d=l()().match,p=Object(k.a)({promiseFn:f.a.getMetadata,sheetId:d.params.sheetId}),b=p.data,g=p.isPending,h=Object(o.useState)({amountFrom:a.amountFrom||"",amountTo:a.amountTo||"",categories:Object(x.h)(a.categories),cities:Object(x.h)(a.cities),currencies:Object(x.h)(a.currencies),methods:Object(x.h)(a.methods),tags:Object(x.h)(a.tags),dateFrom:a.dateFrom&&new Date(a.dateFrom),dateTo:a.dateTo&&new Date(a.dateTo)}),j=Object(r.a)(h,2),O=j[0],E=j[1],v=Object(x.d)(b),C=v.categories,L=v.cities,R=v.currencies,F=v.methods,z=v.tags,W=function(e,t){return E((function(a){var n=Object(y.a)({},a);return n[e]=t,n}))},N=function(e){var t=e.title,a=e.type,r=e.suggestions,o=e.noStyles;return c.a.createElement(m.Column,{flexGrow:1,className:!o&&Object(i.b)(T.inputGroupRow)},c.a.createElement("h3",{className:Object(i.b)(T.subTitle)},t,":"),c.a.createElement(w.o,{onAddition:function(e){return function(e,t){return E((function(a){var r=Object(n.a)(a[e]);if(r.find((function(e){return e.id===t.id})))return a;r.push(t);var o=Object(y.a)({},a);return o[e]=r,o}))}(a,e)},onDelete:function(e){return function(e,t){return E((function(a){var r=Object(n.a)(a[e]);r.splice(t,1);var o=Object(y.a)({},a);return o[e]=r,o}))}(a,e)},suggestions:r,placeholder:"Select ".concat(t),tags:O[a]}))};return c.a.createElement(w.i,{loading:g,fullScreen:!0},c.a.createElement(m.Column,{className:Object(i.b)(T.container)},c.a.createElement(m.Row,{horizontal:"spaced"},c.a.createElement("h1",{className:Object(i.b)(T.title)},"Filters"),c.a.createElement("div",null,c.a.createElement("span",{className:Object(i.b)(T.closeButton),onClick:u},"\u2715"))),c.a.createElement(m.Row,null,N({title:"Categories",type:"categories",suggestions:C,noStyles:!0})),c.a.createElement(m.Row,null,N({title:"Cities",type:"cities",suggestions:L}),N({title:"Currencies",type:"currencies",suggestions:R})),c.a.createElement(m.Row,null,N({title:"Methods",type:"methods",suggestions:F}),N({title:"Tags",type:"tags",suggestions:z})),c.a.createElement(m.Column,null,c.a.createElement(m.Row,{horizontal:"spaced"},c.a.createElement(m.Column,{flexGrow:1,className:Object(i.b)(T.inputGroupRow)},c.a.createElement("h3",{className:Object(i.b)(T.subTitle)},"Date From:"),c.a.createElement(w.d,{startOpen:!1,name:"date-from",selected:O.dateFrom?new Date(O.dateFrom):null,onChange:function(e){return W("dateFrom",e)},value:O.dateFrom?new Date(O.dateFrom):null})),c.a.createElement(m.Column,{flexGrow:1,className:Object(i.b)(T.inputGroupRow)},c.a.createElement("h3",{className:Object(i.b)(T.subTitle)},"Date To:"),c.a.createElement(w.d,{startOpen:!1,name:"date-to",selected:O.dateTo?new Date(O.dateTo):null,onChange:function(e){return W("dateTo",e)},value:O.dateTo?new Date(O.dateTo):null})))),c.a.createElement(m.Column,null,c.a.createElement(m.Row,{horizontal:"spaced"},c.a.createElement(m.Column,{flexGrow:1,className:Object(i.b)(T.inputGroupRow)},c.a.createElement("h3",{className:Object(i.b)(T.subTitle)},"Amount From:"),c.a.createElement(w.h,{value:O.amountFrom,onChange:function(e){return W("amountFrom",e.target.value)}})),c.a.createElement(m.Column,{flexGrow:1,className:Object(i.b)(T.inputGroupRow)},c.a.createElement("h3",{className:Object(i.b)(T.subTitle)},"Amount To:"),c.a.createElement(w.h,{value:O.amountTo,onChange:function(e){return W("amountTo",e.target.value)}})))),c.a.createElement(m.Row,{flexGrow:1,style:{marginTop:20},horizontal:"spaced"},c.a.createElement(w.b,{color:"red",label:"Cancel",onClick:u}),c.a.createElement(w.b,{color:"green",label:"Apply Filters",onClick:function(){var e=Object(y.a)({},O,{categories:O.categories.map((function(e){return e.name})),cities:O.cities.map((function(e){return e.name})),currencies:O.currencies.map((function(e){return e.name})),methods:O.methods.map((function(e){return e.name})),tags:O.tags.map((function(e){return e.name})),dateFrom:O.dateFrom&&O.dateFrom.getTime(),dateTo:O.dateTo&&O.dateTo.getTime()}),t=Object.keys(e).some((function(t){return!!e[t]&&e[t].toString().length>0}));s(t?e:{})}}))))},F=i.a.create({buttonsContainer:{marginTop:10,marginBottom:10},link:{color:"#2c689c",cursor:"pointer",fontSize:14,textDecoration:"underline"},statisticsGlobal:{border:"1px solid #fa7159",borderRadius:5,fontWeight:600,padding:"8px 10px",textAlign:"center"},sideColumnsLeft:{flexGrow:1,width:"100%",maxWidth:240,minWidth:80,"@media (max-width: 1080px)":{maxWidth:880}},sideColumnsRight:{flexGrow:1,width:"100%",maxWidth:240,minWidth:220,paddingTop:56,paddingLeft:10,"@media (max-width: 1080px)":{padding:0,flexDirection:"row",flexWrap:"wrap",justifyContent:"space-between",maxWidth:880,marginTop:20}},showFiltersButton:{margin:"0px 8px","@media (max-width: 768px)":{marginTop:10,marginLeft:0}}});function z(){var e=l()(),t=e.history,a=e.match,s=function(e){var t=Object(o.useState)([]),a=Object(r.a)(t,2),c=a[0],i=a[1],s=Object(o.useState)({}),l=Object(r.a)(s,2),m=l[0],u=l[1],d=Object(o.useState)([]),p=Object(r.a)(d,2),b=p[0],w=p[1],j=Object(o.useState)(!0),O=Object(r.a)(j,2),E=O[0],v=O[1],C=Object(o.useState)(""),L=Object(r.a)(C,2),y=L[0],k=L[1];return Object(o.useEffect)((function(){var t,a,r=!0,o=[],c={},s=function(){var e=Object(h.a)(g.a.mark((function e(t){var a;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.a.getSheet({sheetId:t});case 2:a=e.sent,i(a.expenses),k(a.sheetName),u(a.metadata.statistics),w(a.metadata.tags),o=a.expenses,c=a.metadata,r=!1,v(!1);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return e&&(t=f.a.getExpensesRef({sheetId:e}),a=f.a.getMetadataRef({sheetId:e}),t.on("child_added",(function(e){if(!r){var t=[].concat(Object(n.a)(o),[e.val()]);o=Object(n.a)(t);var a=Object(x.k)(t);i(a)}})),t.on("child_changed",(function(e){if(!r){var t=o.findIndex((function(t){return t.id===e.key})),a=Object(n.a)(o);a[t]=e.val(),o=Object(n.a)(a);var c=Object(x.k)(a);i(c)}})),t.on("child_removed",(function(e){if(!r){var t=o.findIndex((function(t){return t.id===e.key})),a=Object(n.a)(o);a.splice(t,1);var c=Object(x.k)(a);i(c)}})),a.on("child_added",(function(e){r||(c[e.key]=e.val(),u(c.statistics),w(c.tags))})),a.on("child_changed",(function(e){r||(c[e.key]=e.val(),u(c.statistics),w(c.tags))})),a.on("child_removed",(function(e){r||(delete c[e.key],u(c.statistics),w(c.tags))})),s(e)),function(){t&&t.off(),a&&a.off()}}),[e]),{expenses:c,loading:E,sheetName:y,statistics:m,tags:b}}(a.params.sheetId),d=s.expenses,b=s.loading,j=s.statistics,O=s.tags,E=Object(o.useState)([]),v=Object(r.a)(E,2),C=v[0],y=v[1],k=Object(o.useState)([]),T=Object(r.a)(k,2),z=T[0],W=T[1],N=Object(o.useState)(!1),S=Object(r.a)(N,2),D=S[0],G=S[1],M=Object(o.useState)({}),I=Object(r.a)(M,2),B=I[0],A=I[1];Object(o.useEffect)((function(){var e=Object(x.a)(Object(n.a)(d),B);y(e),W(Object(n.a)(e).splice(0,10))}),[d,B]),Object(o.useEffect)((function(){return window.scrollTo(0,0)}),[]);var _=function(e){return t.push("/sheet/".concat(a.params.sheetId,"/edit/").concat(e))},H=Object(x.f)(j),Y=Object.keys(B).length>0,J=C.length/10;return c.a.createElement(w.i,{loading:b,fullScreen:!0},c.a.createElement(m.Column,{horizontal:"center"},c.a.createElement(m.Row,{style:{width:"100%"},horizontal:"spaced",breakpoints:{1080:{flexDirection:"column",alignItems:"center"}}},c.a.createElement("span",{className:Object(i.b)(F.sideColumnsLeft)}),c.a.createElement(m.Column,{style:{maxWidth:880,width:"100%"},breakpoints:{1080:{padding:"0px 10px",maxWidth:880}}},c.a.createElement(m.Row,{className:Object(i.b)(F.buttonsContainer),vertical:"center",horizontal:"spaced",breakpoints:{768:{flexDirection:"column",alignItems:"flex-start"}}},c.a.createElement(w.b,{color:"green",label:"Add Expense",onClick:function(){return t.push("/sheet/".concat(a.params.sheetId,"/new"))}}),c.a.createElement(m.Row,{breakpoints:{768:{flexDirection:"column",alignItems:"flex-start"}}},c.a.createElement(m.Row,{vertical:"end",breakpoints:{768:{flexDirection:"row-reverse"}}},Y&&c.a.createElement("span",{className:Object(i.b)(F.link),onClick:function(){return A({})}},"clear filters"),c.a.createElement(w.b,{className:Object(i.b)(F.showFiltersButton),color:"blue",label:"Filters",onClick:function(){return G(!0)}})),!Y&&c.a.createElement(m.Row,{className:Object(i.b)(F.statisticsGlobal),breakpoints:{768:{marginTop:10}}},function(){if(!j)return"";var e=Object(x.c)(j.lastUpdate,j.minDate);return"Overall Average: $".concat(Object(x.j)(Math.round(j.average||0),0)," / day. ").concat(e," days.")}()))),c.a.createElement(u.a,null,(z||[]).map((function(e){return c.a.createElement(L,{key:e.id,expense:e,onEditClick:_,tags:O||[]})}))),c.a.createElement(w.k,{pageCount:J,onPageChange:function(e){var t=e.selected;W(Object(n.a)(C).splice(10*t,10))}})),c.a.createElement(m.Column,{className:Object(i.b)(F.sideColumnsRight)},Y&&c.a.createElement(w.n,{hideForecast:!0,statistics:Object(x.b)(C),index:3}),H.slice(0).reverse().map((function(e,t){return c.a.createElement(w.n,{key:"statistics-".concat(t),statistics:e,index:t})})),j.categories&&c.a.createElement(w.m,{categories:j.categories,showBorders:!0})))),c.a.createElement(p.a,{isOpen:D,onRequestClose:function(){return G(!1)},style:{content:{border:"1px solid #2c689c",borderRadius:4,top:"50%",left:"50%",right:"auto",bottom:"auto",marginRight:"-50%",transform:"translate(-50%, -50%)",padding:20,zIndex:1102},overlay:{backgroundColor:"rgba(10, 10, 10, .3)",zIndex:1101}},ariaHideApp:!1},c.a.createElement(R,{filters:B,onApply:function(e){A(e),G(!1)},onClose:function(){return G(!1)}})))}z.whyDidYouRender=!1;t.default=z}}]);
//# sourceMappingURL=10.8a8df875.chunk.js.map